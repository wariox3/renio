<div class="d-flex mb-5 justify-content-between align-items-center">
  <div class="d-flex gap-2">
    <app-comun-btn-atras />
    <div class="btn-group btn-sm shadow-sm" role="group" aria-label="Basic example">
      <button type="button" class="btn btn-sm btn-flex bg-body btn-color-gray-700 btn-active-primary btn-text-primary"
        (click)="navegarEditar(programacion.id)" [disabled]="arrEstados.estado_aprobado">
        {{ "FORMULARIOS.BOTONES.COMUNES.EDITAR" | translate }}
      </button>

      <button type="button" class="btn btn-sm btn-flex bg-body btn-color-gray-700 btn-active-primary btn-text-primary"
        (click)="aprobar()" [disabled]="arrEstados.estado_aprobado">
        {{ "FORMULARIOS.BOTONES.COMUNES.APROBAR" | translate }}
      </button>

      <div class="btn-group" ngbDropdown>
        <button type="button" class="btn btn-sm btn-flex bg-body btn-color-gray-700 btn-active-primary btn-text-primary"
          id="dropdownBasic1" ngbDropdownToggle>
          Opciones
        </button>
        <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
          <button ngbDropdownItem (click)="cargarContratos()">
            {{ "FORMULARIOS.BOTONES.COMUNES.CARGARCONTRATOS" | translate }}
          </button>
          <button ngbDropdownItem (click)="generar()">
            {{ "FORMULARIOS.BOTONES.COMUNES.GENERAR" | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<app-card>
  <section card-titulo>
    {{ "FORMULARIOS.BOTONES.COMUNES.DETALLE" | translate | titlecase }}
    {{ "MENU.FUNCIONALIDAD." + (modelo | uppercase) | translate | lowercase }}
  </section>
  <section card-body>
    <table class="table table-bordered table-sm">
      <tbody>
        <tr>
          <td class="fw-bold text-gray-800 fs-6 bg-gray-100" translate="FORMULARIOS.CAMPOS.HUMANO.PROGRAMACION.CODIGO">
          </td>
          <td>{{ programacion.id }}</td>
          <td class="fw-bold text-gray-800 fs-6 bg-gray-100"
            translate="FORMULARIOS.CAMPOS.HUMANO.PROGRAMACION.PAGOTIPO"></td>
          <td>{{ programacion.pago_tipo_nombre }}</td>
        </tr>
        <tr>
          <td class="fw-bold text-gray-800 fs-6 bg-gray-100" translate="FORMULARIOS.CAMPOS.HUMANO.PROGRAMACION.NOMBRE">
          </td>
          <td>{{ programacion.nombre }}</td>
          <td class="fw-bold text-gray-800 fs-6 bg-gray-100" translate="FORMULARIOS.CAMPOS.HUMANO.PROGRAMACION.GRUPO">
          </td>
          <td>{{ programacion.grupo_nombre }}</td>
        </tr>
        <tr>
          <td class="fw-bold text-gray-800 fs-6 bg-gray-100"
            translate="FORMULARIOS.CAMPOS.HUMANO.PROGRAMACION.FECHADESDE"></td>
          <td>{{ programacion.fecha_desde }}</td>
          <td class="fw-bold text-gray-800 fs-6 bg-gray-100"
            translate="FORMULARIOS.CAMPOS.HUMANO.PROGRAMACION.FECHAHASTA"></td>
          <td>{{ programacion.fecha_hasta }}</td>
        </tr>
        <tr>
          <td class="fw-bold text-gray-800 fs-6 bg-gray-100"
            translate="FORMULARIOS.CAMPOS.HUMANO.PROGRAMACION.FECHAHASTAPERIODO"></td>
          <td>{{ programacion.fecha_hasta_periodo }}</td>
        </tr>
      </tbody>
    </table>
    <div class="row mb-5">
      <div class="col-12">
        <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav nav-tabs nav-line-tabs nav-line-tabs-2x mb-5 fs-6">
          <li [ngbNavItem]="1" [destroyOnHide]="true" class="nav-item">
            <a class="nav-link" ngbNavLink data-bs-toggle="tab"
              translate="FORMULARIOS.TITULOS.FACTURACION.DETALLES"></a>
            <ng-template ngbNavContent>
              <div class="table-responsive-sm">
                <table id="tableDetalles" class="table table-bordered table-row-gray-500">
                  <thead>
                    <tr>
                      <th class="bg-gray-100" style="width: 50px">Id</th>
                      <th class="bg-gray-100">
                        <div>Identificaci√≥n</div>
                      </th>
                      <th class="bg-gray-100">
                        <div>Nombre</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Diurna">D</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Nocturna">N</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Festiva diurna">FD</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Festiva nocturna">FN</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Extra diurna">ED</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Extra nocturna">EN</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Extra festiva diurna">EFD</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Extra festiva nocturna">EFN</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Recargo nocturno">RN</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Recargo festivo diurno">RFD</div>
                      </th>
                      <th class="bg-gray-100">
                        <div placement="top" ngbTooltip="Recargo festivo nocturno">RFN</div>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <ng-container *ngFor="let programacionDetalle of arrProgramacionDetalle">
                      <tr>
                        <td style="width: 50px">
                          {{ programacionDetalle.id }}
                        </td>
                        <td>
                          {{
                          programacionDetalle.contrato_contacto_numero_identificacion
                          }}
                        </td>
                        <td>
                          {{
                          programacionDetalle.contrato_contacto_nombre_corto
                          }}
                        </td>
                        <td>{{ programacionDetalle.diurna }}</td>
                        <td>{{ programacionDetalle.nocturna }}</td>
                        <td>{{ programacionDetalle.festiva_diurna }}</td>
                        <td>{{ programacionDetalle.festiva_nocturna }}</td>
                        <td>{{ programacionDetalle.extra_diurna }}</td>
                        <td>{{ programacionDetalle.extra_nocturna }}</td>
                        <td>{{ programacionDetalle.extra_festiva_diurna }}</td>
                        <td>
                          {{ programacionDetalle.extra_festiva_nocturna }}
                        </td>
                        <td>{{ programacionDetalle.recargo_nocturno }}</td>
                        <td>
                          {{ programacionDetalle.recargo_festivo_diurno }}
                        </td>
                        <td>
                          {{ programacionDetalle.recargo_festivo_nocturno }}
                        </td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
              </div>
            </ng-template>
          </li>
          <li [ngbNavItem]="2" [destroyOnHide]="true" class="nav-item">
            <a class="nav-link" ngbNavLink data-bs-toggle="tab"
              translate="FORMULARIOS.TITULOS.HUMPROGRAMACION.ADICIONAL"></a>
            <ng-template ngbNavContent>
              <div class="d-flex justify-content-end my-3">
                <div class="btn-group contenedor-btn-group">
                  <button (click)="abrirModal(content)" class="btn btn-sm btn-primary" type="button"
                    translate="FORMULARIOS.BOTONES.COMUNES.ADICIONAR"></button>
                </div>
              </div>
              <div class="table-responsive-sm">
                <table id="tableDetalles" class="table table-bordered table-sm">
                  <thead>
                    <tr class="bg-gray-100">
                      <th class="bg-gray-100" style="width: 50px">Id</th>
                      <th class="bg-gray-100" translate="FORMULARIOS.TITULOS.COMUNES.IDENTIFICACION"></th>
                      <th class="bg-gray-100" translate="FORMULARIOS.TITULOS.COMUNES.NOMBRE"></th>
                      <th class="bg-gray-100" translate="FORMULARIOS.TITULOS.HUMPROGRAMACION.CONCEPTO"></th>
                      <th class="bg-gray-100" translate="FORMULARIOS.TITULOS.COMUNES.HORAS"></th>
                      <th class="bg-gray-100" translate="FORMULARIOS.TITULOS.COMUNES.VALOR"></th>
                      <th class="bg-gray-100" translate="FORMULARIOS.TITULOS.HUMPROGRAMACION.DIALABORADO"></th>
                    </tr>
                  </thead>
                  <tbody>
                    <ng-container *ngFor="
                        let programacionAdicional of arrProgramacionAdicional
                      ">
                      <tr>
                        <td class="w-40px">{{ programacionAdicional.id }}</td>
                        <td>
                          {{
                          programacionAdicional.contrato_contacto_numero_identificacion
                          }}
                        </td>
                        <td>
                          {{
                          programacionAdicional.contrato_contacto_nombre_corto
                          }}
                        </td>
                        <td>
                          {{ programacionAdicional.concepto_nombre }}
                        </td>
                        <td class="text-end">
                          {{ programacionAdicional.horas }}
                        </td>
                        <td class="text-end">
                          {{ programacionAdicional.valor | number }}
                        </td>
                        <td>
                          {{ programacionAdicional.aplica_dia_laborado ?'SI' : 'NO' }}
                        </td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
              </div>
            </ng-template>
          </li>
        </ul>
        <div [ngbNavOutlet]="nav" class="mt-2"></div>
      </div>
    </div>
  </section>
</app-card>
<ng-template #content let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Adicional</h4>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <form [formGroup]="formularioAdicionalProgramacion">
      <div class="row mb-5">
        <div class="col-12 col-md-12" ngbDropdown #ContratosDropdown="ngbDropdown">
          <label class="form-label required" translate="FORMULARIOS.CAMPOS.HUMANO.ADICIONAL.CONTRATO"></label>
          <div class="position-relative">
            <input type="text" class="form-control" ngbDropdownAnchor formControlName="contrato_nombre"
              (focus)="consultarContratos($event); ContratosDropdown.open()" (keyup)="consultarContratos($event)"
              [ngClass]="{
                'is-invalid':
                  formularioAdicionalProgramacion.controls['contrato']
                    .touched &&
                  formularioAdicionalProgramacion.controls['contrato'].invalid,
                'is-valid':
                  formularioAdicionalProgramacion.controls['contrato']
                    .touched &&
                  formularioAdicionalProgramacion.controls['contrato'].valid
              }" />
            <div class="position-absolute translate-middle-y top-50 end-0 me-3">
              <i class="bi bi-search fs-2"></i>
            </div>
          </div>
          <div ngbDropdownMenu aria-labelledby="dropdownBasic1" class="dropdown-menu">
            <ng-container *ngFor="let contrato of arrContratos">
              <button type="button" ngbDropdownItem (click)="modificarCampoFormulario('contrato', contrato)"
                (pointerenter)="modificarCampoFormulario('contrato', contrato)">
                {{ contrato.contrato_contacto_numero_identificacion }}
                {{ contrato.contrato_contacto_nombre_corto }}
              </button>
            </ng-container>
          </div>
          <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
              validation: 'required',
              message: 'FORMULARIOS.VALIDACIONES.COMUNES.REQUERIDO' | translate,
              control: formularioAdicionalProgramacion.controls['contrato']
            }"></ng-container>
        </div>
      </div>
      <div class="row mb-5">
        <div class="col-12 col-md-12" ngbDropdown #ConceptoDropdown="ngbDropdown">
          <label class="form-label required" translate="FORMULARIOS.CAMPOS.HUMANO.ADICIONAL.CONCEPTO"></label>
          <div class="position-relative">
            <input type="text" class="form-control" ngbDropdownAnchor formControlName="concepto_nombre"
              (focus)="consultarConceptos($event); ConceptoDropdown.open()" (keyup)="consultarConceptos($event)"
              [ngClass]="{
                'is-invalid':
                  formularioAdicionalProgramacion.controls['concepto']
                    .touched &&
                  formularioAdicionalProgramacion.controls['concepto'].invalid,
                'is-valid':
                  formularioAdicionalProgramacion.controls['concepto']
                    .touched &&
                  formularioAdicionalProgramacion.controls['concepto'].valid
              }" />
            <div class="position-absolute translate-middle-y top-50 end-0 me-3">
              <i class="bi bi-search fs-2"></i>
            </div>
          </div>
          <div ngbDropdownMenu aria-labelledby="dropdownBasic1" class="dropdown-menu">
            <ng-container *ngFor="let concepto of arrConceptos">
              <button type="button" ngbDropdownItem (click)="modificarCampoFormulario('concepto', concepto)"
                (pointerenter)="modificarCampoFormulario('concepto', concepto)">
                {{ concepto.concepto_nombre }}
              </button>
            </ng-container>
          </div>
          <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
              validation: 'required',
              message: 'FORMULARIOS.VALIDACIONES.COMUNES.REQUERIDO' | translate,
              control: formularioAdicionalProgramacion.controls['concepto']
            }"></ng-container>
        </div>
      </div>
      <div class="row mb-5">
        <div class="col-12 col-md-6">
          <label class="form-label required" translate="FORMULARIOS.CAMPOS.HUMANO.ADICIONAL.VALOR"></label>
          <input type="number" class="form-control" formControlName="valor" prefix="$ " mask="separator.2" [ngClass]="{
              'is-invalid':
                formularioAdicionalProgramacion.controls['valor'].touched &&
                formularioAdicionalProgramacion.controls['valor'].invalid,
              'is-valid':
                formularioAdicionalProgramacion.controls['valor'].touched &&
                formularioAdicionalProgramacion.controls['valor'].valid
            }" />
          <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
              validation: 'required',
              message: 'FORMULARIOS.VALIDACIONES.COMUNES.REQUERIDO' | translate,
              control: formularioAdicionalProgramacion.controls['valor']
            }"></ng-container>
          <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
              validation: 'pattern',
              message: 'FORMULARIOS.VALIDACIONES.COMUNES.NOVALIDO' | translate,
              control: formularioAdicionalProgramacion.controls['valor']
            }"></ng-container>
        </div>
        <div class="col-12 col-md-6">
          <label class="form-label required" translate="FORMULARIOS.CAMPOS.HUMANO.ADICIONAL.HORAS"></label>
          <input type="number" class="form-control" formControlName="horas" [ngClass]="{
              'is-invalid':
                formularioAdicionalProgramacion.controls['horas'].touched &&
                formularioAdicionalProgramacion.controls['horas'].invalid,
              'is-valid':
                formularioAdicionalProgramacion.controls['horas'].touched &&
                formularioAdicionalProgramacion.controls['horas'].valid
            }" />
          <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
              validation: 'required',
              message: 'FORMULARIOS.VALIDACIONES.COMUNES.REQUERIDO' | translate,
              control: formularioAdicionalProgramacion.controls['horas']
            }"></ng-container>
          <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
              validation: 'pattern',
              message: 'FORMULARIOS.VALIDACIONES.COMUNES.NOVALIDO' | translate,
              control: formularioAdicionalProgramacion.controls['horas']
            }"></ng-container>
        </div>
      </div>
      <div class="row mb-5">
        <div class="col-12 col-md-12">
          <label class="form-label" translate="FORMULARIOS.CAMPOS.HUMANO.ADICIONAL.DETALLE"></label>

          <textarea formControlName="detalle" class="form-control" id="exampleFormControlTextarea1" rows="3"
            (blur)="modificarCampoFormulario('detalle', null)" [ngClass]="{
              'is-invalid':
                formularioAdicionalProgramacion.controls['detalle'].touched &&
                formularioAdicionalProgramacion.controls['detalle'].invalid,
              'is-valid':
                formularioAdicionalProgramacion.controls['detalle'].touched &&
                formularioAdicionalProgramacion.controls['detalle'].valid
            }"></textarea>
          <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
              validation: 'required',
              message: 'FORMULARIOS.VALIDACIONES.COMUNES.REQUERIDO' | translate,
              control: formularioAdicionalProgramacion.controls['detalle']
            }"></ng-container>
        </div>
      </div>
      <div class="row mb-5">
        <div class="col-12 col-md-6">
          <div class="form-check form-check-custom form-check-solid">
            <input class="form-check-input" type="checkbox" value="1" id="flexCheckDefault"
              formControlName="aplica_dia_laborado" />
            <label class="form-check-label text-gray-700" for="flexCheckDefault"
              translate="FORMULARIOS.CAMPOS.HUMANO.ADICIONAL.APLICA_DIA_LABORADO">
            </label>
          </div>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-secondary" (click)="cerrarModal()">
      Guardar
    </button>
  </div>
</ng-template>
<ng-template #formError let-control="control" let-message="message" let-validation="validation"
  let-cantidadCaracteres="cantidadCaracteres">
  <ng-container *ngIf="control.hasError(validation) && (control.dirty || control.touched)">
    <div class="fv-plugins-message-container">
      <div class="fv-help-block">
        <span role="alert"> {{ message }} {{ cantidadCaracteres }} </span>
      </div>
    </div>
  </ng-container>
</ng-template>